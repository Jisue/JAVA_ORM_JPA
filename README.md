# JAVA_ORM_JPA
인프런 「김영한의 자바 ORM 표준 JPA 프로그래밍 - 기본편」 강의 실습 소스코드

## 영속성 컨텍스트
- 엔티티를 영구 저장하는 환경이라는 뜻
- EntityManager.persist(entitisy);
- 엔티티의 생명주기
    - 비영속(new/transient): 영속성 컨텍스트와 전혀 관계가 없는 새로운 상태
    - 영속(managed): 영속성 컨텍스트에 관리되는 상태
    - 준영속(detached): 영속성 컨텍스트에 저장되었다 분리된 상태
    - 삭제(removed): 삭제된 상태
- 영속한 후에 트랜잭션이 실행될 때 영속된 객체가 insert됨
- 1차 캐시를 통해 복잡한 비즈니스 로직때 도움이 됨
- 엔티티 등록: 트랜잭션을 지원하는 쓰기 지연
    - 버퍼링 기능
    - em에 모았다가 한번에 commit가능
- 엔티티 수정: 변경 감지
    - 내부적으로 flush()가 호출되어 스냅샷과 비교후 변경 내용 반영

## 플러시
- 영속성 컨텍스트의 변경내용을 DB에 반영
- 변경 감지
- 수정된 엔티티 쓰기 지연 SQL 저장소에 등록
- 쓰기 지연 SQL 저장소의 쿼리를 D에 전송(등록, 수정, 삭제 쿼리)
- 직접 호출: em.flush()
- 자동 호출: 트랜잭션 커밋, JPQL 쿼리 실행

## 준영속 상태
- 영속 -> 준영속
- 영속 상태의 엔티티가 영속성 컨텍스트에서 분리
- 영속성 컨텍스트가 제공하는 기능을 사용 못함